/* Custom properties for dynamic styling controlled by JS */
:root {
  --grid-size: 8;
  --gap-px: 3px;
  --tile-radius: 2px;
  --icon-size: 26px;
  --side-icon-size: 20px;
  --save-dot-size: 10px;
  --reset-dot-size: 7px;
  --stroke: 3px;
  --gold: #FFD700;
  --glow-color: var(--gold);
 --sim-color: #3F51B5;

}

/* --- MOBILE STABILITY FIXES --- */
html, body {
  height: 100%;
  overflow: hidden;
  position: fixed;
  width: 100%;
}
#appContainer {
  touch-action: none;
}

body {
  touch-action: none;
  -webkit-tap-highlight-color: transparent;
  -webkit-user-select: none; /* Safari */
  -ms-user-select: none; /* IE 10+ */
  user-select: none; /* Standard syntax */
}

/* START: --- Structural Change for Canvas --- */
#board {
  position: relative;
  width: 100%;
  aspect-ratio: 1 / 1;
  /* --- תיקון: הסרנו את התלות של המסגרת במשתנה --- */
  /* עכשיו תמיד תהיה מסגרת דקה, והמרווחים יצוירו בקנבס */
  border: 0px solid black; 
  background-color: #000;
  border-radius: 6px;
  transition: box-shadow 0.3s ease-in-out;
}

#boardCanvas {
  display: block;
  width: 100%;
  height: 100%;
  border-radius: 4px; /* Slightly smaller radius to fit inside the container's border */
}
/* END: --- Structural Change for Canvas --- */


/* --- CONTROL BUTTON STYLES --- */
#controlsContainer {
    position: relative;
    display: grid;
    grid-template-columns: 50px 1fr 50px 50px 50px 1fr 50px;
    grid-template-rows: repeat(4, 50px);
    gap: 8px 6px; /* row-gap | column-gap */
    justify-content: center;
    transition: background-color 0.5s ease-in-out, opacity 0.5s ease-in-out;
}


#controlsContainer.controls-hidden {
    opacity: 0;
    pointer-events: none;
}

.ctrl {
  width: 50px;
  height: 50px;
  cursor: pointer;
  outline: none;
  background: transparent;
  border: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out, background-color 0.3s ease-in-out, visibility 0.4s, grid-area 0.5s ease-in-out, box-shadow 0.3s ease-in-out;
}
.ctrl * {
  pointer-events: none;
}
.ctrl:focus-visible {
  box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.25);
  border-radius: 8px;
}
@media (hover: hover) {
  .ctrl:hover {
    box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.25);
    border-radius: 8px;
  }
}
.ctrl:disabled {
    opacity: 0.3 !important;
    cursor: not-allowed !important;
    box-shadow: none;
    pointer-events: none !important;
}
.glyph {
  width: var(--icon-size);
  height: var(--icon-size);
  display: inline-block;
  position: relative;
}
.ctrl svg {
    width: var(--icon-size);
    height: var(--icon-size);
}
#btnResizeUp svg, #btnResizeDown svg, #btnShowBreatheMenu svg, #btnGap svg, #btnBrushMode svg {
    width: var(--side-icon-size);
    height: var(--side-icon-size);
}
.glyph-square-gold {
  background: #000;
  border: 2px solid var(--gold);
  box-sizing: border-box;
  border-radius: 2px;
}
.glyph-square-white {
  background: #000;
  border: 2px solid #fff;
  box-sizing: border-box;
  border-radius: 2px;
}
.glyph-random {
  background: linear-gradient(90deg, #000 50%, #fff 50%);
  border-radius: 50%;
}
.glyph-invert {
  background: linear-gradient(90deg, #fff 50%, #000 50%);
  border-radius: 50%;
}
.palette {
  font-size: var(--icon-size);
  line-height: 1;
}

.glyph-save, .glyph-reset, .glyph-special-reset, .glyph-dark {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
}
.glyph-save::after {
  content: '';
  width: var(--save-dot-size);
  height: var(--save-dot-size);
  border-radius: 50%;
  background: #FFFFFF;
}

.glyph-reset::after {
  content: '';
  width: var(--reset-dot-size);
  height: var(--reset-dot-size);
  background: #fff;
  border-radius: 50%;
}

.glyph-dark::after {
  content: '';
  width: var(--reset-dot-size);
  height: var(--reset-dot-size);
  background: #424242; /* Dark Gray */
  border-radius: 50%;
}

.glyph-special-reset {
    width: 8px;
    height: 8px;
    background-color: var(--gold);
    border-radius: 50%;
}

#btnGameOfLife,
#btnBrightnessEvo,
#btnShowBreatheMenu,
#btnGravitationalSort,
#btnErosion,
#btnDla,
#btnContour, /* <-- ADDED HERE */
#btnNudgeBrighter,
#btnNudgeDarker {
    opacity: 0;
    pointer-events: none;
    visibility: hidden;
    transform: scale(0.5);
}


/* --- Default Layout --- */
/* Left Panel */
#btnSave           { grid-area: 2 / 1; }
#btnResetBoard     { grid-area: 3 / 1; }
#btnTutorial       { grid-area: 1 / 1; }
#btnSpecialReset   { grid-area: 4 / 1; }


/* Center Panel */
#btnInvert         { grid-area: 1 / 3; }
#btnPalette        { grid-area: 1 / 4; }
#btnRandom         { grid-area: 1 / 5; }

#btnColorPicker    { grid-area: 2 / 3; }
#btnSymmetry       { grid-area: 2 / 4; }
#btnBrushMode      { grid-area: 2 / 5; }

#btnRedo           { grid-area: 3 / 3; }
#btnUndo           { grid-area: 3 / 5; }

#btnToggleSimMode  { grid-area: 4 / 4; }

/* Right Panel */
#btnResizeUp       { grid-area: 1 / 7; }
#btnResizeDown     { grid-area: 2 / 7; }
#btnGap            { grid-area: 3 / 7; }
#btnDark { grid-area: 4 / 7; }

#btnPlayPauseLife {
  grid-area: 1 / 5;
}


/* --- Simulation Mode Layout Overrides --- */
.sim-mode-active #btnBrushMode,
.sim-mode-active #btnGap,
.sim-mode-active #btnResetBoard,
.sim-mode-active #btnTutorial,
.sim-mode-active #btnSpecialReset,
.sim-mode-active #btnInvert {
  display: none;
}

.sim-mode-active #btnGameOfLife,
.sim-mode-active #btnBrightnessEvo,
.sim-mode-active #btnShowBreatheMenu,
.sim-mode-active #btnGravitationalSort,
.sim-mode-active #btnErosion,
.sim-mode-active #btnDla,
.sim-mode-active #btnContour, /* <-- ADDED HERE */
.sim-mode-active #btnNudgeBrighter,
.sim-mode-active #btnNudgeDarker {
    opacity: 1;
    pointer-events: auto;
    visibility: visible;
    transform: scale(1);
}
/* Left Panel */
.sim-mode-active #btnRedo         { grid-area: 4 / 1; }
.sim-mode-active #btnResizeDown  { grid-area: 3 / 1; }
.sim-mode-active #btnColorPicker     { grid-area: 1 / 1; }


/* Center Panel */
.sim-mode-active #btnStepForward     { display: inline-flex; grid-area: 1 / 3; } /* מיקום 1: צעד קדימה */
.sim-mode-active #btnPalette        { grid-area: 1 / 4; }                      /* מיקום 2: החלף פלטה */
.sim-mode-active #btnPlayPauseLife   { grid-area: 1 / 5; }                      /* מיקום 3: הפעל / השהה */

.sim-mode-active #btnGameOfLife      { grid-area: 3 / 4; }
.sim-mode-active #btnShowBreatheMenu { grid-area: 4 / 3; }
.sim-mode-active #btnBrightnessEvo   { grid-area: 2 / 5; }
.sim-mode-active #btnGravitationalSort { grid-area: 3 / 3; }
.sim-mode-active #btnDla             { grid-area: 2 / 4; }
.sim-mode-active #btnErosion         { grid-area: 3 / 5; }
.sim-mode-active #btnToggleSimMode   { grid-area: 4 / 4; }
.sim-mode-active #btnContour         { grid-area: 2 / 3; }

.sim-mode-active #btnSave {
    display: inline-flex; /* הופך את הכפתור לנראה */
    grid-area: 4 / 5;     /* שורה 4, עמודה 3 (מתחת לגרביטציה) */
}

/* Right Panel */
.sim-mode-active #btnSymmetry        { grid-area: 1 / 7; }
.sim-mode-active #btnRandom {
    grid-area: 1 / 7;
    display: none;
}
.sim-mode-active #btnResizeUp   { grid-area: 3 / 7; }
.sim-mode-active #btnDark {
    grid-area: 2 / 7;
    display: none;
}
.sim-mode-active #btnUndo   { grid-area: 4 / 7; }
.sim-mode-active #btnNudgeBrighter { grid-area: 2 / 1; } /* UPDATED and MOVED */
.sim-mode-active #btnNudgeDarker   { grid-area: 2 / 7; } /* UPDATED and MOVED */


#btnBrushMode svg path {
    transition: fill 0.2s ease-in-out;
}
#btnBrushMode.brush-on svg path {
    fill: #fff;
}
.app-shell {
  width: min(85vmin, 720px);
}
#boardOverlay {
    transition: opacity 350ms ease-in-out;
}
@keyframes glow-effect {
  0%, 100% {
    filter: drop-shadow(0 0 0px var(--gold));
    transform: scale(1);
  }
  50% {
    filter: drop-shadow(0 0 8px var(--gold));
    transform: scale(1.1);
  }
}
.glow-animation .glyph-random, .glow-animation .glyph-invert, .glow-animation.palette, .glow-animation svg, .glow-animation .glyph-special-reset {
  animation: glow-effect 2s ease-in-out infinite;
}
.glow-animation-separator svg {
  animation: glow-effect 2s ease-in-out infinite;
}
#saveModal, #colorPickerModal, #helpModal, #resizeModal, #paletteModal, #gameOfLifeSettingsModal, #gravitationalSortSettingsModal, #dlaSettingsModal, #advancedColorMappingModal, #contourSettingsModal {
  transition: opacity 300ms ease-in-out, visibility 300ms ease-in-out;
  visibility: hidden;
  opacity: 0;
}
#saveModal.modal-visible, #colorPickerModal.modal-visible, #helpModal.modal-visible, #resizeModal.modal-visible, #paletteModal.modal-visible, #gameOfLifeSettingsModal.modal-visible, #gravitationalSortSettingsModal.modal-visible, #dlaSettingsModal.modal-visible, #advancedColorMappingModal.modal-visible, #contourSettingsModal.modal-visible {
  visibility: visible;
  opacity: 1;
}

#longPressOverlay {
  background-color: rgba(0, 0, 0, 0.95);
  opacity: 0;
  transition: opacity 200ms ease-out;
}
#longPressDisplay {
  opacity: 0;
  transform: scale(0.95);
  transition: opacity 200ms ease-out 50ms, transform 200ms ease-out 50ms;
}
#longPressOverlay.visible, #longPressDisplay.visible {
  opacity: 1;
}
#longPressDisplay.visible {
    transform: scale(1);
}

@media (max-width: 480px) {
  #controlsContainer {
    grid-template-columns: 44px 1fr 44px 44px 44px 1fr 44px;
    grid-template-rows: repeat(4, 44px);
  }
  .ctrl { width: 44px; height: 44px; }
}

#btnSymmetry .part {
    transition: stroke 0.3s ease-in-out, fill 0.3s ease-in-out;
}

@keyframes breathe {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(0.4); }
}

#splashScreen {
    transition: opacity 2s linear;
}
#splashText {
  letter-spacing: 1.5px;
  word-spacing: 6px;
}
.splash-tutorial-focus {
    z-index: 1001;
    position: relative;
}

@keyframes fadeInText {
  0%   { color: black; opacity: 0; }
  100% { color: var(--gold); opacity: 1; }
}
@keyframes fadeOutText {
  from { color: var(--gold); opacity: 1; }
  to { color: black; opacity: 0; }
}

.save-tile {
  width: 90px;
  height: 90px;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: none;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
}
.save-tile:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
}
.save-tile svg {
  width: 40px;
  height: 40px;
}

#colorPickerModal .color-swatch {
    position: relative;
    width: 100%;
    padding-top: 100%;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
    border: 2px solid transparent;
    box-sizing: border-box;
}
#colorPickerModal .color-swatch:hover {
    transform: scale(1.1);
}
#colorPickerPagination .pagination-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #4a4a4a;
    margin: 0 4px;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
}
#colorPickerPagination .pagination-dot.active {
    background-color: #eaeaea;
}
#colorPickerModal .color-swatch-inner {
    position: absolute;
    inset: 0;
    border-radius: inherit;
}

#helpModalContent::-webkit-scrollbar, #paletteModalGrid::-webkit-scrollbar { width: 6px; }
#helpModalContent::-webkit-scrollbar-track, #paletteModalGrid::-webkit-scrollbar-track { background: #2d2d2d; border-radius: 3px; }
#helpModalContent::-webkit-scrollbar-thumb, #paletteModalGrid::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }
#helpModalContent::-webkit-scrollbar-thumb:hover, #paletteModalGrid::-webkit-scrollbar-thumb:hover { background: #777; }
.help-item-icon-wrapper {
    width: 50px;
    height: 50px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}
.help-item-icon-wrapper .glyph,
.help-item-icon-wrapper svg {
  width: var(--icon-size);
  height: var(--icon-size);
}
.help-item-icon-wrapper .palette { font-size: var(--icon-size); }
.help-item-icon-wrapper #btnResizeUp svg,
.help-item-icon-wrapper #btnResizeDown svg,
.help-item-icon-wrapper #btnShowBreatheMenu svg,
.help-item-icon-wrapper #btnGap svg,
.help-item-icon-wrapper #btnBrushMode svg {
    width: var(--side-icon-size);
}

#resizeInput:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.4);
    outline: none;
}
#btnConfirmResize {
    background-color: var(--gold);
    transition: background-color 0.2s;
}
#btnConfirmResize:hover {
    background-color: #e6c200;
}
.help-category-title {
    font-size: 1.1rem;
    font-weight: bold;
    color: var(--gold);
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    border-bottom: 1px solid #444;
    padding-bottom: 0.25rem;
}
.help-intro-text {
    font-style: italic;
    color: #ccc;
    margin-bottom: 1rem;
    text-align: center;
}

/* --- Glowing Border for Selected Color --- */
#board.glowing-border {
  animation: glow-border 3s 2;
}
#board.glowing-border-rainbow {
   animation: glow-border-rainbow 3s 2;
}

@keyframes glow-border {
  50% {
    box-shadow: 0 0 12px 4px var(--glow-color);
  }
}
@keyframes glow-border-rainbow {
  0% { box-shadow: 0 0 12px 4px #ff0000; }
  16% { box-shadow: 0 0 12px 4px #ff7f00; }
  33% { box-shadow: 0 0 12px 4px #ffff00; }
  50% { box-shadow: 0 0 12px 4px #00ff00; }
  66% { box-shadow: 0 0 12px 4px #0000ff; }
  83% { box-shadow: 0 0 12px 4px #4b0082; }
  100% { box-shadow: 0 0 12px 4px #8f00ff; }
}

.rtl-mode {
  direction: rtl;
}

/* --- Onboarding Styles --- */
.ctrl.onboarding-hidden {
  visibility: hidden;
  opacity: 0;
  transform: scale(0.8);
  pointer-events: none;
}

.ctrl.onboarding-visible {
    visibility: visible;
    opacity: 1;
    transform: scale(1);
    pointer-events: auto;
}

#btnResetOnboarding {
    margin: 1.5rem auto 0;
    display: block;
    width: 44px;
    height: 50px;
    background-color: var(--gold);
    border: none;
    cursor: pointer;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    transition: transform 0.2s ease-out, background-color 0.2s ease-out;
}
#btnResetOnboarding:hover {
    transform: scale(1.1);
    background-color: #e6c200;
}
 .palette-preview {
    cursor: pointer;
    background-color: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 12px;
    transition: background-color 0.2s ease-in-out, transform 0.2s ease-out;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}
.palette-preview:hover {
    background-color: rgba(255, 255, 255, 0.15);
    transform: translateY(-4px);
}
.palette-preview-icon {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    line-height: 1;
}
.palette-preview-name {
    font-size: 0.8rem;
    text-align: center;
    color: #ccc;
}
.kbd-key {
    background-color: #3a3a3a;
    border: 1px solid #555;
    border-radius: 4px;
    padding: 2px 6px;
    font-family: monospace;
    font-size: 0.9em;
    color: #eaeaea;
    margin: 0 2px;
    box-shadow: 0 2px 0 #222;
    display: inline-block;
}

/* --- Simulation Mode Styles --- */
.control-hidden {
    opacity: 0;
    transform: scale(0.5);
    pointer-events: none;
    visibility: hidden;
}

#btnToggleSimMode.active svg {
    stroke: var(--gold);
}

/* --- START: MODIFIED STYLE FOR "ARMED" SIMULATION BUTTON --- */
.ctrl.simulation-active {
    transform: scale(1.1); /* Make button slightly larger */
}

#btnGameOfLife.simulation-active svg,
#btnBrightnessEvo.simulation-active svg,
#btnShowBreatheMenu.simulation-active svg,
#btnGravitationalSort.simulation-active svg,
#btnErosion.simulation-active svg,
#btnDla.simulation-active svg,
#btnContour.simulation-active svg /* <-- ADDED HERE */ {
  stroke: var(--gold);
  stroke-width: 2.5; /* Make the icon lines thicker */
}
/* --- END: MODIFIED STYLE FOR "ARMED" SIMULATION BUTTON --- */

/* --- Play/Pause Button Icon Colors --- */

/* צובע את אייקון ה-Play (כשהוא זמין) ואת אייקון ה-Pause בצבע זהב */
.sim-mode-active #btnPlayPauseLife:not(:disabled) #iconPlay,
.sim-mode-active #btnPlayPauseLife #iconPause {
  fill: var(--gold);
}


/* --- START: Game of Life Settings Modal Styles --- */
#gameOfLifeSettingsModal input[type="number"]:focus,
#gameOfLifeSettingsModal select:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.4);
    outline: none;
}

#btnGolSettingsSave:hover {
    background-color: #e6c200 !important;
}
/* --- END: Game of Life Settings Modal Styles --- */

/* --- START: New Gravitational Sort Settings Modal Styles --- */
.gs-direction-btn {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: 2px solid #444;
  background-color: #2a2a2a;
  font-size: 24px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
}
.gs-direction-btn:hover {
  border-color: #666;
  transform: translateY(-2px);
}
.gs-direction-btn.active {
  border-color: var(--gold);
  box-shadow: 0 0 8px var(--gold);
  color: var(--gold);
}

#gsStrength::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #eaeaea;
  cursor: pointer;
  margin-top: -6px; /* Center thumb on the track */
}
#gsStrength::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #eaeaea;
  cursor: pointer;
}
#gsStrength:focus {
    outline: none;
}
#gsStrength:focus::-webkit-slider-thumb {
    box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.5);
}

#btnGsSettingsSave:hover, #btnContourSettingsSave:hover {
    background-color: #e6c200 !important;
}

/* --- END: New Gravitational Sort Settings Modal Styles --- */

/* --- START: New DLA Settings Modal Styles --- */
#btnDlaSettingsSave:hover {
    background-color: #e6c200 !important;
}
/* --- END: New DLA Settings Modal Styles --- */


/* --- START: New Step Forward Button Styles --- */
#btnStepForward {
  display: none; /* Hide by default */
  color: #666; /* Default disabled color */
  transition: color 0.3s ease;
}

/* Color the Step Forward icon with gold when active */
#btnStepForward:not(:disabled) {
  color: var(--gold); /* <-- שינוי הצבע לזהב */
}


/* --- END: New Step Forward Button Styles --- */


/* --- Custom Simulation Button Color --- */
#btnGameOfLife svg,
#btnBrightnessEvo svg,
#btnGravitationalSort svg,
#btnErosion svg,
#btnContour svg /* <-- ADDED HERE */ {
    stroke: var(--sim-color); /* צובע את קווי המתאר של האייקון */
}

#btnShowBfreatheMenu svg circle {
    fill: var(--sim-color); /* צובע את העיגולים המלאים באייקון הנשימה */
}

#btnDla svg {
    fill: var(--sim-color); /* צובע את האייקון המלא של DLA */
}


/* --- Styling for the central grid wrapper in simulation mode --- */

/* זהו אלמנט הרקע החדש שהוספנו. הוא מוסתר כברירת מחדל */
#simModeBackground {
  display: none;
  z-index: -1; /* ממקם אותו מאחורי הכפתורים */
}

/* כשאנחנו במצב סימולציה, אנחנו מציגים את הרקע ומעצבים אותו */
.sim-mode-active #simModeBackground {
  display: block;
  
  /* מיקום הרקע בדיוק על 3 העמודות המרכזיות ו-4 השורות */
  grid-column: 3 / span 3;
  grid-row: 2 / span 2;
  
  /* העיצוב של המעטפת */
  background: linear-gradient(to bottom, #0f172a, #000000);
  border-radius: 12px;
  border: 1px solid #334155;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
}




/* --- Brush Size Slider Styles --- */
#brushSizeSlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #eaeaea;
  cursor: pointer;
  margin-top: -6px; 
}

#brushSizeSlider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #eaeaea;
  cursor: pointer;
}

#brushSizeSlider:focus {
    outline: none;
}

#brushSizeSlider:focus::-webkit-slider-thumb {
    box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.5);
}

/* --- Brightness Evolution Button States --- */
#btnBrightnessEvo.mode-brightness svg {
    stroke: var(--gold);
}
#btnBrightnessEvo.mode-contrast svg {
    stroke: url(#contrastGradient);
}

/* --- DLA Button States --- */
#btnDla.mode-genetics svg circle {
    fill: var(--gold);
}
#btnDla.mode-no-genetics svg #dla-circle-top {
    fill: var(--gold);
}

/* --- Breathe Button States --- */
#btnShowBreatheMenu #iconBreatheSolo {
    display: block;
}
#btnShowBreatheMenu #iconBreatheGroup {
    display: none;
}
/* Solo mode (Armed) */
#btnShowBreatheMenu.mode-solo #iconBreatheSolo { display: block; }
#btnShowBreatheMenu.mode-solo #iconBreatheGroup { display: none; }
#btnShowBreatheMenu.mode-solo svg { stroke: var(--gold); }

/* Group mode (Armed) */
#btnShowBreatheMenu.mode-group #iconBreatheSolo { display: none; }
#btnShowBreatheMenu.mode-group #iconBreatheGroup { display: block; }
#btnShowBreatheMenu.mode-group svg { stroke: var(--gold); }
}


/* --- START: GOL Preset Button Styles --- */
.gol-preset-btn {
  font-size: 0.8rem; /* גודל פונט קטן יותר שיתאים לכפתורים */
  padding: 8px 4px; /* ריפוד פנימי */
  background-color: #37474F; /* רקע כהה שמתאים לאפליקציה */
  color: #ECEFF1; /* צבע טקסט בהיר */
  border: 1px solid #546E7A; /* מסגרת עדינה */
  border-radius: 6px; /* פינות מעוגלות */
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  text-align: center;
}

/* אפקט ריחוף (עכבר מעל) */
.gol-preset-btn:hover {
  background-color: #455A64;
  border-color: #78909C;
  transform: translateY(-2px); /* הרמה קלה */
}

/* אפקט לחיצה */
.gol-preset-btn:active {
  background-color: #263238;
  transform: translateY(0); /* החזרה למקום */
}

/* --- END: GOL Preset Button Styles --- */



/* --- START: New GOL Chip Button Styles --- */
.gol-chip-btn {
  width: 40px;
  height: 40px;
  border-radius: 50%; /* Make them circular */
  border: 1px solid #546E7A; /* Subtle border */
  background-color: #37474F; /* Default dark background */
  color: #ECEFF1; /* Light text */
  font-family: monospace; /* Give it a 'tech' feel */
  font-size: 1rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  display: flex;
  align-items: center;
  justify-content: center;
}

.gol-chip-btn:hover {
  background-color: #455A64;
  border-color: #78909C;
  transform: scale(1.05); /* Slight grow on hover */
}

/* This is the active/selected state */
.gol-chip-btn.active {
  background-color: var(--gold); /* Gold background */
  color: #000000; /* Black text */
  border-color: var(--gold);
  box-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
}
/* --- END: New GOL Chip Button Styles --- */


/* === START: New Preset Button Active Style === */
.gol-preset-btn.active {
  background-color: var(--gold); /* Gold background */
  color: #000000; /* Black text */
  border-color: var(--gold);
  box-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
  transform: translateY(-2px); /* Lift it up slightly */
}
/* === END: New Preset Button Active Style === */
}

/* --- START: New Contour Settings Modal Styles --- */
#contourSensitivitySlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #eaeaea;
  cursor: pointer;
  margin-top: -6px; /* Center thumb on the track */
}
#contourSensitivitySlider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #eaeaea;
  cursor: pointer;
}
#contourSensitivitySlider:focus {
    outline: none;
}
#contourSensitivitySlider:focus::-webkit-slider-thumb {
    box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.5);
}

#btnContourSettingsSave:hover {
    background-color: #e6c200 !important;
}
/* --- END: New Contour Settings Modal Styles --- */


/* --- Game of Life Responsive Fix --- */

/* 1. הגדרות ברירת מחדל (דסקטופ) - מראה נקי ומרווח */
#golSurvivalChipsContainer,
#golBirthChipsContainer {
    display: flex;
    justify-content: center;
    flex-wrap: wrap; /* בדסקטופ: אפשר לרדת שורה, זה בסדר */
    gap: 6px;
}

.gol-chip-btn {
    width: 36px;  /* גודל נוח ללחיצה עם העכבר */
    height: 36px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    font-size: 1rem;
    transition: transform 0.1s, background-color 0.2s; /* אנימציה חלקה */
}

/* ביטול אפקט הגדלה במובייל כדי למנוע קפיצות, השארת צבע בלבד */
@media (hover: hover) {
    .gol-chip-btn:hover {
        transform: scale(1.1); 
    }
}

/* 2. הגדרות מובייל בלבד (עד רוחב 600px) - שורה אחת קומפקטית */
@media (max-width: 600px) {
    #golSurvivalChipsContainer,
    #golBirthChipsContainer {
        flex-wrap: nowrap !important; /* הכרח שורה אחת */
        overflow-x: auto;             /* אפשר גלילה הצידה אם צריך */
        justify-content: center;      /* מירכוז */
        gap: 3px !important;          /* צמצום רווחים */
        padding-bottom: 4px;          /* מונע חיתוך של הצל */
        
        /* הסתרת פס הגלילה (Scrollbar) שיהיה אסתטי */
        -ms-overflow-style: none;  /* IE/Edge */
        scrollbar-width: none;     /* Firefox */
    }
    
    /* הסתרת פס גלילה לכרום/ספארי */
    #golSurvivalChipsContainer::-webkit-scrollbar,
    #golBirthChipsContainer::-webkit-scrollbar {
        display: none;
    }

    .gol-chip-btn {
        width: 30px !important;   /* ריבועים קטנים */
        height: 30px !important;
        font-size: 0.85rem;
        flex-shrink: 0;           /* שלא יתכווצו */
    }
}
